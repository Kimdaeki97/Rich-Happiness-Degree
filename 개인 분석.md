서울시 사람들 중 돈이 많을 수록 행복지수가 높을까?
==================================================

1. 요약, 분석 주제
------------------

'돈 많은게 최고의 행복이다'라는 말은 사람들 누구나 공감하는 말일 것이다.
그렇다면 과연 부자들은 다 행복할까? 돈을 많이 벌면 누구나 다 행복할까?
라는 말들이 실제로 그런지, 또 그 사람들은 어느 지역에 살고 있는지
알아보기 위해 분석을 진행하였다.

2. 데이터 선정
--------------

우선 위에 명제에는 '재산'과 '행복지수' 두가지의 변수가 있다.

재산은 서울시 각 자치구의 지방세 세목별·세입 단위별(시세·구세) 징수들이
있는 데이터에서 재산세 데이터를 사용했고, 행복지수는 서울시
통계데이터담부에서 설문조사를 통해 서울시민을 대상으로 각 자치 구별로
0부터 10까지의 주관적인 행복정도를 측정한 데이터를 사용했다. 그리고
재정상태, 사회생활, 건강상태 등에 따른 행복지수들이 있었는데 그런 것들을
합친 종합 행복지수로 측정하기로 했다.

3. 분석
-------

#### (1) 필요한 패키지 불러오기

    library(dplyr)
    library(ggplot2)
    library(readxl)

\*데이터 출처: I seoul U 서울통계

    load("df_total.rda")

    tax <- read_excel("2016 지방세징수.xls")
    tax<-tax %>% filter(기간 != '기간' & 자치구별 != '서울시' & 자치구별 != '본청') %>% select(`보통세__7`, `보통세__11`)
    df_total <- cbind(df_total, tax)

    df_total<-rename(df_total, `재산세`=`보통세__11`)

    df_total[, 24:33] <- sapply(df_total[, 24:33], function(`행복지수(재정상태)`){as.numeric(as.character(`행복지수(재정상태)`))})

#### (2) 데이터 파악하기

    head(df_total,3)

    ##   기간   구분     계 0~4세 5~9세 10~14세 15~19세 20~24세 25~29세 30~34세
    ## 1 2016 종로구 157423  4995  4903    5539    7883   11580   14051   12263
    ## 2 2016   중구 131145  4909  4017    3587    5160    8553   10936   11058
    ## 3 2016 용산구 234241  9469  8411    8221   10701   14650   18988   21088
    ##   35~39세 40~44세 45~49세 50~54세 55~59세 60~64세 65~69세 70~74세 75~79세
    ## 1   11262   12180   13169   13062   12664   10007    7598    6280    5059
    ## 2   10274    9974   10884   11303   11664    8941    6754    5348    3853
    ## 3   19865   19557   19109   18623   18134   13878   10742    8897    7039
    ##   80~84세 85~89세 90~94세 95세 이상+ 취득세 종합 행복지수
    ## 1    2924    1379     482        143 137454          6.88
    ## 2    2383    1067     384         96 243277          6.75
    ## 3    4159    1846     709        155 213768          6.69
    ##   행복지수(건강상태) 행복지수(재정상태) 행복지수(관계상태)
    ## 1               7.11               6.20               7.01
    ## 2               6.95               6.15               6.86
    ## 3               6.88               6.18               6.75
    ##   행복지수(가정생활) 행복지수(사회생활) 전체평균연령 보통세__7 재산세
    ## 1               7.16               6.93         43.4    331716  77699
    ## 2               6.99               6.79         43.8    656505  96793
    ## 3               6.83               6.80         42.7    159618  80559

    View(df_total)
    str(df_total)

    ## 'data.frame':    25 obs. of  33 variables:
    ##  $ 기간              : chr  "2016" "2016" "2016" "2016" ...
    ##  $ 구분              : chr  "종로구" "중구" "용산구" "성동구" ...
    ##  $ 계                : num  157423 131145 234241 289789 357921 ...
    ##  $ 0~4세             : num  4995 4909 9469 12672 14074 ...
    ##  $ 5~9세             : num  4903 4017 8411 10548 12294 ...
    ##  $ 10~14세           : num  5539 3587 8221 9979 12889 ...
    ##  $ 15~19세           : num  7883 5160 10701 13447 18840 ...
    ##  $ 20~24세           : num  11580 8553 14650 20400 26883 ...
    ##  $ 25~29세           : num  14051 10936 18988 24985 35304 ...
    ##  $ 30~34세           : num  12263 11058 21088 26001 33756 ...
    ##  $ 35~39세           : num  11262 10274 19865 24710 29012 ...
    ##  $ 40~44세           : num  12180 9974 19557 23190 27862 ...
    ##  $ 45~49세           : num  13169 10884 19109 23278 29158 ...
    ##  $ 50~54세           : num  13062 11303 18623 23563 29279 ...
    ##  $ 55~59세           : num  12664 11664 18134 22962 27912 ...
    ##  $ 60~64세           : num  10007 8941 13878 17197 20535 ...
    ##  $ 65~69세           : num  7598 6754 10742 13055 14779 ...
    ##  $ 70~74세           : num  6280 5348 8897 10072 10821 ...
    ##  $ 75~79세           : num  5059 3853 7039 7373 7603 ...
    ##  $ 80~84세           : num  2924 2383 4159 3958 4176 ...
    ##  $ 85~89세           : num  1379 1067 1846 1699 1880 ...
    ##  $ 90~94세           : num  482 384 709 555 676 ...
    ##  $ 95세 이상+        : num  143 96 155 145 188 194 218 262 192 201 ...
    ##  $ 취득세            : num  137454 243277 213768 149712 109881 ...
    ##  $ 종합 행복지수     : num  6.88 6.75 6.69 6.9 6.87 6.71 6.82 6.86 6.8 6.66 ...
    ##  $ 행복지수(건강상태): num  7.11 6.95 6.88 7.02 7.13 6.91 7.1 7 7.01 6.86 ...
    ##  $ 행복지수(재정상태): num  6.2 6.15 6.18 6.34 6.09 5.96 6.14 6.19 6.06 5.96 ...
    ##  $ 행복지수(관계상태): num  7.01 6.86 6.75 6.98 7.07 6.92 6.94 7.03 7.01 6.76 ...
    ##  $ 행복지수(가정생활): num  7.16 6.99 6.83 7.15 7.1 6.96 7 7.11 6.99 6.91 ...
    ##  $ 행복지수(사회생활): num  6.93 6.79 6.8 7.03 6.97 6.81 6.91 6.98 6.93 6.8 ...
    ##  $ 전체평균연령      : num  43.4 43.8 42.7 41.3 40.5 42.3 42.2 41.5 43.5 42.4 ...
    ##  $ 보통세__7         : num  331716 656505 159618 77232 57416 ...
    ##  $ 재산세            : num  77699 96793 80559 65107 62759 ...

#### (3) 필요한 데이터 선택

재산세가 '재정상태'를 대변할 수 있는 요인으로 판단하여 재산세를 변수로
지정하였다. 행복지수를 측정하기 위해 종합 행복지수를 변수로 지정하였다.
또한 각 구별의 특성도 알아보기 위해 지역을 나타낸 구분도 변로
지정하였다.

    moneyhappy <- df_total %>% select(`구분`,`재산세`,`종합 행복지수`)
    head(moneyhappy)

    ##       구분 재산세 종합 행복지수
    ## 1   종로구  77699          6.88
    ## 2     중구  96793          6.75
    ## 3   용산구  80559          6.69
    ## 4   성동구  65107          6.90
    ## 5   광진구  62759          6.87
    ## 6 동대문구  61529          6.71

#### (4) 선택한 변수들을 작업하기 편하게 rename

    moneyhappy <- rename(moneyhappy, city = 구분)
    moneyhappy <- rename(moneyhappy, money = 재산세)
    moneyhappy <- rename(moneyhappy, happy = `종합 행복지수`)

#### (5) 데이터를 자유롭게 분석해보기

우선 평균 재산세와 평균 행복지수를 구해봤다.

    mean(moneyhappy$happy)

    ## [1] 6.9408

    mean(moneyhappy$money)

    ## [1] 79187.8

그 후 재산세, 행복지수를 각각의 평균과 비교하여 평균 이상이면 up 평균
미만이면 down 을 표시한 파생변수를 추가하였다.

    moneyhappy <- moneyhappy %>% 
      mutate(hp_avr = ifelse(happy >= mean(happy), "up", "down")) %>% 
      mutate(my_avr = ifelse(money >= mean(money), "up", "down"))
    moneyhappy %>% select(hp_avr, my_avr)

    ##    hp_avr my_avr
    ## 1    down   down
    ## 2    down     up
    ## 3    down     up
    ## 4    down   down
    ## 5    down   down
    ## 6    down   down
    ## 7    down   down
    ## 8    down   down
    ## 9    down   down
    ## 10   down   down
    ## 11     up   down
    ## 12     up   down
    ## 13   down   down
    ## 14     up   down
    ## 15     up   down
    ## 16     up     up
    ## 17     up   down
    ## 18     up   down
    ## 19     up     up
    ## 20     up   down
    ## 21     up   down
    ## 22     up     up
    ## 23     up     up
    ## 24     up     up
    ## 25   down   down

비교해본 결과 평균 재산세와 평균 행복지수가 서로 다르게 나온 것보다 둘다
up이거나 down인 경우가 많다. 구체적인 분석을 하기 전에 약간의 예측을 할
수 있었다.

본격적으로 그래프를 이용한 분석을 하였다.

    ggplot(data = moneyhappy, aes(x = money, y = happy)) + 
      geom_point() +
      geom_text(aes(label=city, size=0, vjust=1, hjust=0))+
       ggtitle("서울시별 재산에 따른 종합 행복지수")+
      stat_smooth(method=lm, level=0.95)

![](kdk_files/figure-markdown_strict/unnamed-chunk-8-1.png)

그래프 결과 일부 극단치들을 제외하고 봤을 때 재산세가 높을수록
행복지수가 높아지는 것을 볼 수 있다.

따라서 재산이 많을수록 행복지수가 높게 나온다는 것을 데이터를 통해
증명할 수 있다.

4. 한계점과 비판점
------------------

전체적으로 극단치 값을 제외하고 보면 재산과 행복지수는 보편적으로 비례
관계가 보인다.

하지만 그래프에서 보여지는 몇몇 극단치 값들에 대해서 논리적으로 설명할
방법이 부족하다. 단순히 예외적인 부분이라고 설명할 수만은 없을 것 같다.
